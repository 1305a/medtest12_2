(function(){"use strict";var t={4026:function(t,e,n){var o=n(9242),s=n(3396);function i(t,e){const n=(0,s.up)("router-view");return(0,s.wg)(),(0,s.j4)(n)}var a=n(89);const r={},d=(0,a.Z)(r,[["render",i]]);var u=d,l=n(2483),c=n(7139);const h={class:"main-wrapper"},T={class:"question-page"},v=["onClick"],p={class:"text-question-wrapper"},_={class:"text-question-wrapper"},m=(0,s._)("hr",{style:{width:"700px"}},null,-1),w={class:"branch-list"},I={class:"column-id"},g=(0,s._)("div",null,"Текст ответа",-1),x=["onUpdate:modelValue"],f=["onClick"],E=["onClick"],D=["onClick"],y={key:0,style:{width:"700px"}},q={key:1,class:"text-question-wrapper"},A=(0,s._)("hr",{style:{width:"700px"}},null,-1);function k(t,e,n,i,a,r){const d=(0,s.up)("QuestionstModal"),u=(0,s.up)("WarningModal");return(0,s.wg)(),(0,s.iD)("div",h,[(0,s._)("div",T,[(0,s._)("h2",null,"Вопрос id: "+(0,c.zw)(a.questionId),1),(0,s._)("div",null,[(0,s._)("button",{onClick:e[0]||(e[0]=t=>r.selectQuestion("moveToNode"))}," Перейти на другой узел ")]),(0,s._)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.parentList,(t=>((0,s.wg)(),(0,s.iD)("button",{key:t.id,onClick:e=>r.moveToId(t.id)}," Перейти к родителю "+(0,c.zw)(t.id),9,v)))),128))]),(0,s._)("div",p,[(0,s.Uk)(" Текст: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.infoText=t),class:"text-info-question"},"\r\n        ",512),[[o.nr,a.infoText,void 0,{lazy:!0}]])]),(0,s._)("div",null,[(0,s.Uk)(" Количество баллов: "),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.nodePoints=t),type:"number",class:"input-points"},null,512),[[o.nr,a.nodePoints,void 0,{lazy:!0}]])]),(0,s.wy)((0,s._)("div",_,[(0,s.Uk)(" Вопрос: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.questionText=t),class:"text-info-question"},"          \r\n        ",512),[[o.nr,a.questionText,void 0,{lazy:!0}]])],512),[[o.F8,!1]]),m,(0,s._)("div",null,[(0,s._)("button",{onClick:e[4]||(e[4]=(...t)=>r.ADD_QUESTION&&r.ADD_QUESTION(...t))}," Добавить новый узел "),(0,s._)("button",{onClick:e[5]||(e[5]=t=>r.selectQuestion("addNode"))}," Выбрать узел "),(0,s._)("button",{onClick:e[6]||(e[6]=t=>a.isShowResumeText=!a.isShowResumeText)}," Показать текст резюме ")]),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.answerTransitions,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"branch-item"},[(0,s._)("div",I," id: "+(0,c.zw)(t.transitionId),1),(0,s._)("div",null,[g,(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e=>t.answerText=e,class:"answer-text"},null,8,x),[[o.nr,t.answerText]])]),(0,s._)("button",{onClick:e=>r.moveToId(t.transitionId)},"Перейти",8,f),(0,s._)("button",{onClick:e=>r.CHECK_AND_DELETE(t.transitionId)},"Удалить узел",8,E),(0,s._)("button",{onClick:e=>r.DELETE_BRANCH(t.transitionId)},"Удалить ветку",8,D)])))),128))]),a.isShowResumeText?((0,s.wg)(),(0,s.iD)("hr",y)):(0,s.kq)("",!0),a.isShowResumeText?((0,s.wg)(),(0,s.iD)("div",q,[(0,s.Uk)(" Текст резюме: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>a.resumeText=t),class:"text-info-question"},"\r\n        ",512),[[o.nr,a.resumeText,void 0,{lazy:!0}]])])):(0,s.kq)("",!0),A,(0,s._)("button",{onClick:e[8]||(e[8]=(...t)=>r.saveData&&r.saveData(...t)),class:"button-save"},"Сохранить")]),a.showQuestionsModal?((0,s.wg)(),(0,s.j4)(d,{key:0,serverURL:a.serverURL,testId:a.testId,token:a.token,action:a.actionQuestionsModal,onCloseModal:r.closeModal,onAddQuestion:e[9]||(e[9]=t=>r.addQuestion(t)),onMoveToQuestion:e[10]||(e[10]=t=>r.moveToQuestion(t))},null,8,["serverURL","testId","token","action","onCloseModal"])):(0,s.kq)("",!0),a.showWarning?((0,s.wg)(),(0,s.j4)(u,{key:1,warningText:a.warningText,onCloseWarning:r.closeWarning},null,8,["warningText","onCloseWarning"])):(0,s.kq)("",!0)])}n(7658);var b=n(4161);const Q={class:"questions-modal"},U={key:0},N={key:1},O={class:"questions-table"},L=(0,s._)("th",null,"id",-1),M=(0,s._)("th",null,"текст",-1),C=["onClick"],S={class:"table-cell"},$={class:"table-cell"};function R(t,e,n,i,a,r){return(0,s.wg)(),(0,s.iD)("div",{onClick:e[0]||(e[0]=(0,o.iM)(((...t)=>r.closeModal&&r.closeModal(...t)),["self"])),class:"modal-wrapper"},[(0,s._)("div",Q,["addNode"===n.action?((0,s.wg)(),(0,s.iD)("h2",U," Добавить переход ")):(0,s.kq)("",!0),"moveToNode"===n.action?((0,s.wg)(),(0,s.iD)("h2",N," Перейти к узлу ")):(0,s.kq)("",!0),(0,s._)("table",O,[L,M,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.questionsList,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id,onClick:e=>r.selectQuestion(t.id),class:"table-row"},[(0,s._)("td",S,(0,c.zw)(t.id),1),(0,s._)("td",$,(0,c.zw)(t.body.infoText),1)],8,C)))),128))])])])}var z={data(){return{questionsList:[]}},props:{serverURL:String,testId:Number,token:String,action:String},methods:{GET_QUESTIONS_DATA(){(0,b.Z)({method:"get",url:`${this.serverURL}/admin/test/${this.testId}/questions`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.questionsList=t.data.data})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},closeModal(){this.$emit("closeModal")},selectQuestion(t){"addNode"===this.action&&(this.$emit("addQuestion",t),this.closeModal()),"moveToNode"===this.action&&(this.$emit("moveToQuestion",t),this.closeModal())}},mounted(){this.GET_QUESTIONS_DATA()}};const Z=(0,a.Z)(z,[["render",R]]);var W=Z;const P={class:"warning-wrapper"},G={class:"warning-window"},J={class:"warning-footer"};function j(t,e,n,o,i,a){return(0,s.wg)(),(0,s.iD)("div",P,[(0,s._)("div",G,[(0,s._)("div",null,(0,c.zw)(n.warningText),1),(0,s._)("div",J,[(0,s._)("button",{onClick:e[0]||(e[0]=(...t)=>a.closeWarning&&a.closeWarning(...t))}," Ok ")])])])}var B={props:{warningText:String},methods:{closeWarning(){this.$emit("closeWarning")}}};const F=(0,a.Z)(B,[["render",j]]);var H=F,V={data(){return{serverURL:"https://dev1.med-game.ru/api/v1",testId:25,questionId:813,parentList:[],parentInfoText:"",parentQuestionText:"",infoText:"",nodePoints:0,questionText:"",answerTransitions:[],showQuestionsModal:!1,actionQuestionsModal:"",showWarning:!1,warningText:"",isShowResumeText:!1,resumeText:"",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2ODU4NDE3NTAuMDk4MzM2LCJpYXQiOjE2ODQ3NjE3NTAuMDk4MzM5LCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZXMiOlsiYWRtaW4tcGFydCIsIm1hbmFnZS11c2VycyIsIm1hbmFnZS1yb2xlcyJdfQ.L9tHifvKEszq_faJRovWGDiVQ-3vB6aqFxvph2DZvwY"}},components:{QuestionstModal:W,WarningModal:H},computed:{},methods:{GET_QUESTION_DATA(){(0,b.Z)({method:"get",url:`${this.serverURL}/admin/question/${this.questionId}`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.setData(t.data.data)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},UPDATE_QUESTION_DATA(){(0,b.Z)({url:`${this.serverURL}/admin/question/${this.questionId}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:this.parentList,infoText:this.infoText,nodePoints:this.nodePoints,questionText:this.questionText,answerTransitions:this.answerTransitions,resumeText:this.resumeText}}}).catch((function(t){console.log(t)}))},DELETE_QUESTION(t){(0,b.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"delete",headers:{Authorization:`Bearer ${this.token}`}}).then((()=>{const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHECK_AND_DELETE(t){(0,b.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>e.data.data.body.answerTransitions.length?(this.warningText="Нельзя удалять объект. У удаляемого объекта есть зависимые узлы.",void(this.showWarning=!0)):e.data.data.body.parentList.length>1?(this.warningText="Нельзя удалять объект. У удаляемого объекта больше одного родителя.",void(this.showWarning=!0)):void this.DELETE_QUESTION(t))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},ADD_QUESTION(){(0,b.Z)({url:`${this.serverURL}/admin/questions`,method:"post",headers:{Authorization:`Bearer ${this.token}`},data:{question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:[{id:this.questionId}],infoText:"",nodePoints:"",questionText:"",answerTransitions:[]}}}).then((t=>{this.answerTransitions.push({transitionId:t.data.data.id,answerText:""}),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHANGE_QUESTION(t,e){(0,b.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{...e}}}).catch((function(t){console.log(t)}))},GET_AND_ADD_PARENT(t){(0,b.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;n.parentList.push({id:this.questionId}),this.CHANGE_QUESTION(t,n)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},DELETE_BRANCH(t){(0,b.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;if(n.parentList.length<2)return!1;const o=n.parentList.findIndex((t=>t.id===this.questionId));return o>=0?(n.parentList.splice(o,1),this.CHANGE_QUESTION(t,n),!0):void 0})).then((e=>{if(e){const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&(this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA())}else this.warningText="Нельзя удалить ветку, так как у дочернего элемента только один родитель.",this.showWarning=!0})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},setData(t){this.parentList=t.body.parentList,this.infoText=t.body.infoText,this.nodePoints=t.body.nodePoints,this.questionText=t.body.questionText,this.answerTransitions=t.body.answerTransitions,this.resumeText=t.body.resumeText?t.body.resumeText:""},saveData(){this.UPDATE_QUESTION_DATA()},moveToId(t){this.questionId=t,this.GET_QUESTION_DATA()},selectQuestion(t){this.actionQuestionsModal=t,this.showQuestionsModal=!0},closeModal(){this.showQuestionsModal=!1,this.actionQuestionsModal=""},addQuestion(t){this.answerTransitions.push({transitionId:t,answerText:""}),this.GET_AND_ADD_PARENT(t),this.UPDATE_QUESTION_DATA(),this.actionQuestionsModal=""},moveToQuestion(t){this.moveToId(t),this.actionQuestionsModal=""},closeWarning(){this.showWarning=!1,this.warningText=""}},mounted(){this.GET_QUESTION_DATA()}};const Y=(0,a.Z)(V,[["render",k]]);var X=Y;const K=[{path:"/",name:"QuestionPage2",component:X},{path:"/test:testId/question:questionId",name:"question",component:X}],tt=(0,l.p7)({history:(0,l.r5)(),routes:K});var et=tt,nt=n(65),ot=(0,nt.MT)({state:{serverURL:"https://dev1.med-game.ru/api/v1",testId:11,questionId:563,parentId:0,parentInfoText:"",parentQuestionText:"",infoText:"",questionText:"",answerTransitions:[],currentMoveId:0,isActiveQuestion:!0,token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2ODU4NDE3NTAuMDk4MzM2LCJpYXQiOjE2ODQ3NjE3NTAuMDk4MzM5LCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZXMiOlsiYWRtaW4tcGFydCIsIm1hbmFnZS11c2VycyIsIm1hbmFnZS1yb2xlcyJdfQ.L9tHifvKEszq_faJRovWGDiVQ-3vB6aqFxvph2DZvwY"},getters:{questionId(t){return t.questionId},parentId(t){return t.parentId},infoText(t){return t.infoText},questionText(t){return t.questionText},answerTransitions(t){return t.answerTransitions}},mutations:{setDataQuestion(t,e){t.parentId=e.body.parentId,t.infoText=e.body.infoText,t.questionText=e.body.questionText,t.answerTransitions=e.body.answerTransitions},setParentTexts(t,e){t.parentInfoText=e.body.infoText,t.parentQuestionText=e.body.questionText}},actions:{GET_QUESTION_DATA({state:t,commit:e,dispatch:n}){(0,b.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.questionId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setDataQuestion",t.data.data),console.log(t)})).then((()=>!t.parentId||n("GET_PARENT_TEXTS"))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},GET_PARENT_TEXTS({state:t,commit:e}){(0,b.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.parentId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setParentTexts",t.data.data),console.log("33333333333"),console.log(t)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},moveToId({state:t,dispatch:e},n){return t.questionId=n,e("GET_QUESTION_DATA")}},modules:{}}),st=n(9529);n(4415);(0,o.ri)(u).use(ot).use(et).use(st.Z).mount("#app")}},e={};function n(o){var s=e[o];if(void 0!==s)return s.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,o,s,i){if(!o){var a=1/0;for(l=0;l<t.length;l++){o=t[l][0],s=t[l][1],i=t[l][2];for(var r=!0,d=0;d<o.length;d++)(!1&i||a>=i)&&Object.keys(n.O).every((function(t){return n.O[t](o[d])}))?o.splice(d--,1):(r=!1,i<a&&(a=i));if(r){t.splice(l--,1);var u=s();void 0!==u&&(e=u)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[o,s,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var s,i,a=o[0],r=o[1],d=o[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);if(d)var l=d(n)}for(e&&e(o);u<a.length;u++)i=a[u],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(l)},o=self["webpackChunkmedtest12"]=self["webpackChunkmedtest12"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(4026)}));o=n.O(o)})();
//# sourceMappingURL=app.e1bbc4de.js.map