(function(){"use strict";var t={361:function(t,e,n){var o=n(9242),i=n(3396);function s(t,e){const n=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(n)}var a=n(89);const r={},d=(0,a.Z)(r,[["render",s]]);var u=d,l=n(2483),c=n(7139);const h={class:"main-wrapper"},T={class:"question-page"},I=["onClick"],w={class:"text-question-wrapper"},_={class:"text-question-wrapper"},v=(0,i._)("hr",{style:{width:"700px"}},null,-1),g={class:"branch-list"},p={class:"column-id"},m=(0,i._)("div",null,"Текст ответа",-1),x=["onUpdate:modelValue"],y=["onClick"],f=["onClick"],E=["onClick"],D={key:0,style:{width:"700px"}},A={key:1,class:"text-question-wrapper"},b=(0,i._)("hr",{style:{width:"700px"}},null,-1);function q(t,e,n,s,a,r){const d=(0,i.up)("QuestionstModal"),u=(0,i.up)("WarningModal");return(0,i.wg)(),(0,i.iD)("div",h,[(0,i._)("div",T,[(0,i._)("h2",null,"Вопрос id: "+(0,c.zw)(a.questionId),1),(0,i._)("div",null,[(0,i._)("button",{onClick:e[0]||(e[0]=t=>r.selectQuestion("moveToNode"))}," Перейти на другой узел ")]),(0,i._)("div",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.parentList,(t=>((0,i.wg)(),(0,i.iD)("button",{key:t.id,onClick:e=>r.moveToId(t.id)}," Перейти к родителю "+(0,c.zw)(t.id),9,I)))),128))]),(0,i._)("div",w,[(0,i.Uk)(" Текст: "),(0,i.wy)((0,i._)("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.infoText=t),class:"text-info-question"},"\r\n        ",512),[[o.nr,a.infoText,void 0,{lazy:!0}]])]),(0,i._)("div",null,[(0,i.Uk)(" Количество баллов: "),(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.nodePoints=t),type:"number",class:"input-points"},null,512),[[o.nr,a.nodePoints,void 0,{lazy:!0}]])]),(0,i.wy)((0,i._)("div",_,[(0,i.Uk)(" Вопрос: "),(0,i.wy)((0,i._)("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.questionText=t),class:"text-info-question"},"          \r\n        ",512),[[o.nr,a.questionText,void 0,{lazy:!0}]])],512),[[o.F8,!1]]),v,(0,i._)("div",null,[(0,i._)("button",{onClick:e[4]||(e[4]=(...t)=>r.ADD_QUESTION&&r.ADD_QUESTION(...t))}," Добавить новый узел "),(0,i._)("button",{onClick:e[5]||(e[5]=t=>r.selectQuestion("addNode"))}," Выбрать узел "),(0,i._)("button",{onClick:e[6]||(e[6]=t=>a.isShowResumeText=!a.isShowResumeText)}," Показать текст резюме ")]),(0,i._)("div",g,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.answerTransitions,((t,e)=>((0,i.wg)(),(0,i.iD)("div",{key:e,class:"branch-item"},[(0,i._)("div",p," id: "+(0,c.zw)(t.transitionId),1),(0,i._)("div",null,[m,(0,i.wy)((0,i._)("textarea",{"onUpdate:modelValue":e=>t.answerText=e,class:"answer-text"},null,8,x),[[o.nr,t.answerText]])]),(0,i._)("button",{onClick:e=>r.moveToId(t.transitionId)},"Перейти",8,y),(0,i._)("button",{onClick:e=>r.CHECK_AND_DELETE(t.transitionId)},"Удалить узел",8,f),(0,i._)("button",{onClick:e=>r.DELETE_BRANCH(t.transitionId)},"Удалить ветку",8,E)])))),128))]),a.isShowResumeText?((0,i.wg)(),(0,i.iD)("hr",D)):(0,i.kq)("",!0),a.isShowResumeText?((0,i.wg)(),(0,i.iD)("div",A,[(0,i.Uk)(" Текст резюме: "),(0,i.wy)((0,i._)("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>a.resumeText=t),class:"text-info-question"},"\r\n        ",512),[[o.nr,a.resumeText,void 0,{lazy:!0}]])])):(0,i.kq)("",!0),b,(0,i._)("button",{onClick:e[8]||(e[8]=(...t)=>r.saveData&&r.saveData(...t)),class:"button-save"},"Сохранить")]),a.showQuestionsModal?((0,i.wg)(),(0,i.j4)(d,{key:0,serverURL:a.serverURL,testId:a.testId,token:a.token,action:a.actionQuestionsModal,onCloseModal:r.closeModal,onAddQuestion:e[9]||(e[9]=t=>r.addQuestion(t)),onMoveToQuestion:e[10]||(e[10]=t=>r.moveToQuestion(t))},null,8,["serverURL","testId","token","action","onCloseModal"])):(0,i.kq)("",!0),a.showWarning?((0,i.wg)(),(0,i.j4)(u,{key:1,warningText:a.warningText,onCloseWarning:r.closeWarning},null,8,["warningText","onCloseWarning"])):(0,i.kq)("",!0)])}n(7658);var k=n(4161);const U={class:"questions-modal"},Q={key:0},N={key:1},L={class:"questions-table"},O=(0,i._)("th",null,"id",-1),M=(0,i._)("th",null,"текст",-1),C=["onClick"],S={class:"table-cell"},$={class:"table-cell"};function W(t,e,n,s,a,r){return(0,i.wg)(),(0,i.iD)("div",{onClick:e[0]||(e[0]=(0,o.iM)(((...t)=>r.closeModal&&r.closeModal(...t)),["self"])),class:"modal-wrapper"},[(0,i._)("div",U,["addNode"===n.action?((0,i.wg)(),(0,i.iD)("h2",Q," Добавить переход ")):(0,i.kq)("",!0),"moveToNode"===n.action?((0,i.wg)(),(0,i.iD)("h2",N," Перейти к узлу ")):(0,i.kq)("",!0),(0,i._)("table",L,[O,M,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.questionsList,(t=>((0,i.wg)(),(0,i.iD)("tr",{key:t.id,onClick:e=>r.selectQuestion(t.id),class:"table-row"},[(0,i._)("td",S,(0,c.zw)(t.id),1),(0,i._)("td",$,(0,c.zw)(t.body.infoText),1)],8,C)))),128))])])])}var z={data(){return{questionsList:[]}},props:{serverURL:String,testId:Number,token:String,action:String},methods:{GET_QUESTIONS_DATA(){(0,k.Z)({method:"get",url:`${this.serverURL}/admin/test/${this.testId}/questions`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.questionsList=t.data.data})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},closeModal(){this.$emit("closeModal")},selectQuestion(t){"addNode"===this.action&&(this.$emit("addQuestion",t),this.closeModal()),"moveToNode"===this.action&&(this.$emit("moveToQuestion",t),this.closeModal())}},mounted(){this.GET_QUESTIONS_DATA()}};const R=(0,a.Z)(z,[["render",W]]);var P=R;const G={class:"warning-wrapper"},j={class:"warning-window"},Z={class:"warning-footer"};function J(t,e,n,o,s,a){return(0,i.wg)(),(0,i.iD)("div",G,[(0,i._)("div",j,[(0,i._)("div",null,(0,c.zw)(n.warningText),1),(0,i._)("div",Z,[(0,i._)("button",{onClick:e[0]||(e[0]=(...t)=>a.closeWarning&&a.closeWarning(...t))}," Ok ")])])])}var Y={props:{warningText:String},methods:{closeWarning(){this.$emit("closeWarning")}}};const V=(0,a.Z)(Y,[["render",J]]);var X=V,B={data(){return{serverURL:"https://dev1.med-game.ru/api/v1",testId:25,questionId:813,parentList:[],parentInfoText:"",parentQuestionText:"",infoText:"",nodePoints:0,questionText:"",answerTransitions:[],showQuestionsModal:!1,actionQuestionsModal:"",showWarning:!1,warningText:"",isShowResumeText:!1,resumeText:"",token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2ODgyNDQxMDIuNzg2NTIyMiwiaWF0IjoxNjg3MTY0MTAyLjc4NjUyMjIsInVzZXJuYW1lIjoiYWRtaW4iLCJyb2xlcyI6WyJhZG1pbi1wYXJ0IiwibWFuYWdlLXVzZXJzIiwibWFuYWdlLXJvbGVzIl19.Tdmc_a7sgEQnUDOi4dnD6vGtIAsmdtSMOiIuGvePDq0"}},components:{QuestionstModal:P,WarningModal:X},computed:{},methods:{GET_QUESTION_DATA(){(0,k.Z)({method:"get",url:`${this.serverURL}/admin/question/${this.questionId}`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.setData(t.data.data)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},UPDATE_QUESTION_DATA(){(0,k.Z)({url:`${this.serverURL}/admin/question/${this.questionId}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:this.parentList,infoText:this.infoText,nodePoints:this.nodePoints,questionText:this.questionText,answerTransitions:this.answerTransitions,resumeText:this.resumeText}}}).catch((function(t){console.log(t)}))},DELETE_QUESTION(t){(0,k.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"delete",headers:{Authorization:`Bearer ${this.token}`}}).then((()=>{const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHECK_AND_DELETE(t){(0,k.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>e.data.data.body.answerTransitions.length?(this.warningText="Нельзя удалять объект. У удаляемого объекта есть зависимые узлы.",void(this.showWarning=!0)):e.data.data.body.parentList.length>1?(this.warningText="Нельзя удалять объект. У удаляемого объекта больше одного родителя.",void(this.showWarning=!0)):void this.DELETE_QUESTION(t))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},ADD_QUESTION(){(0,k.Z)({url:`${this.serverURL}/admin/questions`,method:"post",headers:{Authorization:`Bearer ${this.token}`},data:{question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:[{id:this.questionId}],infoText:"",nodePoints:"",questionText:"",answerTransitions:[]}}}).then((t=>{this.answerTransitions.push({transitionId:t.data.data.id,answerText:""}),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHANGE_QUESTION(t,e){(0,k.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{...e}}}).catch((function(t){console.log(t)}))},GET_AND_ADD_PARENT(t){(0,k.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;n.parentList.push({id:this.questionId}),this.CHANGE_QUESTION(t,n)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},DELETE_BRANCH(t){(0,k.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;if(n.parentList.length<2)return!1;const o=n.parentList.findIndex((t=>t.id===this.questionId));return o>=0?(n.parentList.splice(o,1),this.CHANGE_QUESTION(t,n),!0):void 0})).then((e=>{if(e){const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&(this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA())}else this.warningText="Нельзя удалить ветку, так как у дочернего элемента только один родитель.",this.showWarning=!0})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},setData(t){this.parentList=t.body.parentList,this.infoText=t.body.infoText,this.nodePoints=t.body.nodePoints,this.questionText=t.body.questionText,this.answerTransitions=t.body.answerTransitions,this.resumeText=t.body.resumeText?t.body.resumeText:""},saveData(){this.UPDATE_QUESTION_DATA()},moveToId(t){this.questionId=t,this.GET_QUESTION_DATA()},selectQuestion(t){this.actionQuestionsModal=t,this.showQuestionsModal=!0},closeModal(){this.showQuestionsModal=!1,this.actionQuestionsModal=""},addQuestion(t){this.answerTransitions.push({transitionId:t,answerText:""}),this.GET_AND_ADD_PARENT(t),this.UPDATE_QUESTION_DATA(),this.actionQuestionsModal=""},moveToQuestion(t){this.moveToId(t),this.actionQuestionsModal=""},closeWarning(){this.showWarning=!1,this.warningText=""}},mounted(){this.GET_QUESTION_DATA()}};const H=(0,a.Z)(B,[["render",q]]);var F=H;const K=[{path:"/",name:"QuestionPage2",component:F},{path:"/test:testId/question:questionId",name:"question",component:F}],tt=(0,l.p7)({history:(0,l.r5)(),routes:K});var et=tt,nt=n(65),ot=(0,nt.MT)({state:{serverURL:"https://dev1.med-game.ru/api/v1",testId:11,questionId:563,token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2ODgyNDQxMDIuNzg2NTIyMiwiaWF0IjoxNjg3MTY0MTAyLjc4NjUyMjIsInVzZXJuYW1lIjoiYWRtaW4iLCJyb2xlcyI6WyJhZG1pbi1wYXJ0IiwibWFuYWdlLXVzZXJzIiwibWFuYWdlLXJvbGVzIl19.Tdmc_a7sgEQnUDOi4dnD6vGtIAsmdtSMOiIuGvePDq0"},getters:{testId(t){return t.testId},questionId(t){return t.questionId}},mutations:{setDataQuestion(t,e){t.parentId=e.body.parentId,t.infoText=e.body.infoText,t.questionText=e.body.questionText,t.answerTransitions=e.body.answerTransitions},setParentTexts(t,e){t.parentInfoText=e.body.infoText,t.parentQuestionText=e.body.questionText}},actions:{GET_QUESTION_DATA({state:t,commit:e,dispatch:n}){(0,k.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.questionId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setDataQuestion",t.data.data),console.log(t)})).then((()=>!t.parentId||n("GET_PARENT_TEXTS"))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},GET_PARENT_TEXTS({state:t,commit:e}){(0,k.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.parentId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setParentTexts",t.data.data),console.log("33333333333"),console.log(t)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},moveToId({state:t,dispatch:e},n){return t.questionId=n,e("GET_QUESTION_DATA")}},modules:{}}),it=n(9529);n(4415);(0,o.ri)(u).use(ot).use(et).use(it.Z).mount("#app")}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var s=e[o]={exports:{}};return t[o].call(s.exports,s,s.exports,n),s.exports}n.m=t,function(){var t=[];n.O=function(e,o,i,s){if(!o){var a=1/0;for(l=0;l<t.length;l++){o=t[l][0],i=t[l][1],s=t[l][2];for(var r=!0,d=0;d<o.length;d++)(!1&s||a>=s)&&Object.keys(n.O).every((function(t){return n.O[t](o[d])}))?o.splice(d--,1):(r=!1,s<a&&(a=s));if(r){t.splice(l--,1);var u=i();void 0!==u&&(e=u)}}return e}s=s||0;for(var l=t.length;l>0&&t[l-1][2]>s;l--)t[l]=t[l-1];t[l]=[o,i,s]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,s,a=o[0],r=o[1],d=o[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(d)var l=d(n)}for(e&&e(o);u<a.length;u++)s=a[u],n.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return n.O(l)},o=self["webpackChunkmedtest12"]=self["webpackChunkmedtest12"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(361)}));o=n.O(o)})();
//# sourceMappingURL=app.efeaf81d.js.map