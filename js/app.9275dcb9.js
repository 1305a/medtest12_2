(function(){"use strict";var t={3830:function(t,e,n){var o=n(9242),s=n(3396);function i(t,e){const n=(0,s.up)("router-view");return(0,s.wg)(),(0,s.j4)(n)}var a=n(89);const r={},d=(0,a.Z)(r,[["render",i]]);var l=d,u=n(2483),h=n(7139);const c={key:0,class:"main-wrapper"},T={class:"question-page"},g=["onClick"],p={class:"text-question-wrapper"},_={class:"text-question-wrapper"},w=(0,s._)("hr",{style:{width:"700px"}},null,-1),v={class:"branch-list"},m={class:"column-id"},I=(0,s._)("div",null,"Текст ответа",-1),x=["onUpdate:modelValue"],f=["onClick"],k=["onClick"],A=["onClick"],E={key:0,style:{width:"700px"}},q={key:1,class:"text-question-wrapper"},y=(0,s._)("hr",{style:{width:"700px"}},null,-1);function D(t,e,n,i,a,r){const d=(0,s.up)("QuestionstModal"),l=(0,s.up)("WarningModal"),u=(0,s.up)("LoginModal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[a.isAuth?((0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("div",T,[(0,s._)("h2",null,"Вопрос id: "+(0,h.zw)(a.questionId),1),(0,s._)("div",null,[(0,s._)("button",{onClick:e[0]||(e[0]=t=>r.selectQuestion("moveToNode"))}," Перейти на другой узел ")]),(0,s._)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.parentList,(t=>((0,s.wg)(),(0,s.iD)("button",{key:t.id,onClick:e=>r.moveToId(t.id)}," Перейти к родителю "+(0,h.zw)(t.id),9,g)))),128))]),(0,s._)("div",p,[(0,s.Uk)(" Текст: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.infoText=t),class:"text-info-question"},"\r\n        ",512),[[o.nr,a.infoText,void 0,{lazy:!0}]])]),(0,s._)("div",null,[(0,s.Uk)(" Количество баллов: "),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.nodePoints=t),type:"number",class:"input-points"},null,512),[[o.nr,a.nodePoints,void 0,{lazy:!0}]])]),(0,s.wy)((0,s._)("div",_,[(0,s.Uk)(" Вопрос: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.questionText=t),class:"text-info-question"},"          \r\n        ",512),[[o.nr,a.questionText,void 0,{lazy:!0}]])],512),[[o.F8,!1]]),w,(0,s._)("div",null,[(0,s._)("button",{onClick:e[4]||(e[4]=(...t)=>r.ADD_QUESTION&&r.ADD_QUESTION(...t))}," Добавить новый узел "),(0,s._)("button",{onClick:e[5]||(e[5]=t=>r.selectQuestion("addNode"))}," Выбрать узел "),(0,s._)("button",{onClick:e[6]||(e[6]=t=>a.isShowResumeText=!a.isShowResumeText)}," Показать текст резюме ")]),(0,s._)("div",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.answerTransitions,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"branch-item"},[(0,s._)("div",m," id: "+(0,h.zw)(t.transitionId),1),(0,s._)("div",null,[I,(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e=>t.answerText=e,class:"answer-text"},null,8,x),[[o.nr,t.answerText]])]),(0,s._)("button",{onClick:e=>r.moveToId(t.transitionId)},"Перейти",8,f),(0,s._)("button",{onClick:e=>r.CHECK_AND_DELETE(t.transitionId)},"Удалить узел",8,k),(0,s._)("button",{onClick:e=>r.DELETE_BRANCH(t.transitionId)},"Удалить ветку",8,A)])))),128))]),a.isShowResumeText?((0,s.wg)(),(0,s.iD)("hr",E)):(0,s.kq)("",!0),a.isShowResumeText?((0,s.wg)(),(0,s.iD)("div",q,[(0,s.Uk)(" Текст резюме: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>a.resumeText=t),class:"text-info-question"},"\r\n        ",512),[[o.nr,a.resumeText,void 0,{lazy:!0}]])])):(0,s.kq)("",!0),y,(0,s._)("button",{onClick:e[8]||(e[8]=(...t)=>r.saveData&&r.saveData(...t)),class:"button-save"},"Сохранить")]),a.showQuestionsModal?((0,s.wg)(),(0,s.j4)(d,{key:0,serverURL:a.serverURL,testId:a.testId,token:a.token,action:a.actionQuestionsModal,onCloseModal:r.closeModal,onAddQuestion:e[9]||(e[9]=t=>r.addQuestion(t)),onMoveToQuestion:e[10]||(e[10]=t=>r.moveToQuestion(t))},null,8,["serverURL","testId","token","action","onCloseModal"])):(0,s.kq)("",!0),a.showWarning?((0,s.wg)(),(0,s.j4)(l,{key:1,warningText:a.warningText,onCloseWarning:r.closeWarning},null,8,["warningText","onCloseWarning"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),a.isAuth?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:1,onSignIn:r.LOGINING},null,8,["onSignIn"]))],64)}n(7658);var U=n(4161);const b={class:"questions-modal"},Q={key:0},N={key:1},L={class:"questions-table"},S=(0,s._)("th",null,"id",-1),$=(0,s._)("th",null,"текст",-1),O=["onClick"],C={class:"table-cell"},M={class:"table-cell"};function R(t,e,n,i,a,r){return(0,s.wg)(),(0,s.iD)("div",{onClick:e[0]||(e[0]=(0,o.iM)(((...t)=>r.closeModal&&r.closeModal(...t)),["self"])),class:"modal-wrapper"},[(0,s._)("div",b,["addNode"===n.action?((0,s.wg)(),(0,s.iD)("h2",Q," Добавить переход ")):(0,s.kq)("",!0),"moveToNode"===n.action?((0,s.wg)(),(0,s.iD)("h2",N," Перейти к узлу ")):(0,s.kq)("",!0),(0,s._)("table",L,[S,$,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.questionsList,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id,onClick:e=>r.selectQuestion(t.id),class:"table-row"},[(0,s._)("td",C,(0,h.zw)(t.id),1),(0,s._)("td",M,(0,h.zw)(t.body.infoText),1)],8,O)))),128))])])])}var P={data(){return{questionsList:[]}},props:{serverURL:String,testId:Number,token:String,action:String},methods:{GET_QUESTIONS_DATA(){(0,U.Z)({method:"get",url:`${this.serverURL}/admin/test/${this.testId}/questions`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.questionsList=t.data.data})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},closeModal(){this.$emit("closeModal")},selectQuestion(t){"addNode"===this.action&&(this.$emit("addQuestion",t),this.closeModal()),"moveToNode"===this.action&&(this.$emit("moveToQuestion",t),this.closeModal())}},mounted(){this.GET_QUESTIONS_DATA()}};const z=(0,a.Z)(P,[["render",R]]);var G=z;const Z={class:"warning-wrapper"},W={class:"warning-window"},B={class:"warning-footer"};function H(t,e,n,o,i,a){return(0,s.wg)(),(0,s.iD)("div",Z,[(0,s._)("div",W,[(0,s._)("div",null,(0,h.zw)(n.warningText),1),(0,s._)("div",B,[(0,s._)("button",{onClick:e[0]||(e[0]=(...t)=>a.closeWarning&&a.closeWarning(...t))}," Ok ")])])])}var j={props:{warningText:String},methods:{closeWarning(){this.$emit("closeWarning")}}};const V=(0,a.Z)(j,[["render",H]]);var K=V;const Y={class:"login-wrapper"},F={class:"login-container"},X={class:"login-text-input"},J=(0,s._)("div",{class:"login-text"}," Логин: ",-1),tt={class:"login-text-input"},et=(0,s._)("div",{class:"login-text"}," Пароль: ",-1);function nt(t,e,n,i,a,r){return(0,s.wg)(),(0,s.iD)("div",Y,[(0,s._)("div",F,[(0,s._)("div",X,[J,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.login=t),type:"text"},null,512),[[o.nr,a.login]])]),(0,s._)("div",tt,[et,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.password=t),type:"password"},null,512),[[o.nr,a.password]])]),(0,s._)("button",{onClick:e[2]||(e[2]=(...t)=>r.signIn&&r.signIn(...t)),class:"login-button"}," Войти ")])])}var ot={data(){return{login:"",password:""}},methods:{signIn(){this.$emit("signIn",{login:this.login,password:this.password})}}};const st=(0,a.Z)(ot,[["render",nt]]);var it=st,at={data(){return{serverURL:"https://dev1.med-game.ru/api/v1",authServer:"https://dev1.med-game.ru",testId:25,questionId:813,parentList:[],parentInfoText:"",parentQuestionText:"",infoText:"",nodePoints:0,questionText:"",answerTransitions:[],showQuestionsModal:!1,actionQuestionsModal:"",showWarning:!1,warningText:"",isShowResumeText:!1,resumeText:"",isAuth:!1,token:""}},components:{QuestionstModal:G,WarningModal:K,LoginModal:it},computed:{},methods:{GET_QUESTION_DATA(){(0,U.Z)({method:"get",url:`${this.serverURL}/admin/question/${this.questionId}`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.setData(t.data.data)})).catch((t=>(console.log("Ошибка:"),console.log(t),401===t.response.request.status&&(this.isAuth=!1),t)))},UPDATE_QUESTION_DATA(){(0,U.Z)({url:`${this.serverURL}/admin/question/${this.questionId}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:this.parentList,infoText:this.infoText,nodePoints:this.nodePoints,questionText:this.questionText,answerTransitions:this.answerTransitions,resumeText:this.resumeText}}}).catch((function(t){console.log(t)}))},DELETE_QUESTION(t){(0,U.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"delete",headers:{Authorization:`Bearer ${this.token}`}}).then((()=>{const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHECK_AND_DELETE(t){(0,U.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>e.data.data.body.answerTransitions.length?(this.warningText="Нельзя удалять объект. У удаляемого объекта есть зависимые узлы.",void(this.showWarning=!0)):e.data.data.body.parentList.length>1?(this.warningText="Нельзя удалять объект. У удаляемого объекта больше одного родителя.",void(this.showWarning=!0)):void this.DELETE_QUESTION(t))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},ADD_QUESTION(){(0,U.Z)({url:`${this.serverURL}/admin/questions`,method:"post",headers:{Authorization:`Bearer ${this.token}`},data:{question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:[{id:this.questionId}],infoText:"",nodePoints:"",questionText:"",answerTransitions:[]}}}).then((t=>{this.answerTransitions.push({transitionId:t.data.data.id,answerText:""}),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHANGE_QUESTION(t,e){(0,U.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{...e}}}).catch((function(t){console.log(t)}))},GET_AND_ADD_PARENT(t){(0,U.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;n.parentList.push({id:this.questionId}),this.CHANGE_QUESTION(t,n)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},DELETE_BRANCH(t){(0,U.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;if(n.parentList.length<2)return!1;const o=n.parentList.findIndex((t=>t.id===this.questionId));return o>=0?(n.parentList.splice(o,1),this.CHANGE_QUESTION(t,n),!0):void 0})).then((e=>{if(e){const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&(this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA())}else this.warningText="Нельзя удалить ветку, так как у дочернего элемента только один родитель.",this.showWarning=!0})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},setData(t){this.parentList=t.body.parentList,this.infoText=t.body.infoText,this.nodePoints=t.body.nodePoints,this.questionText=t.body.questionText,this.answerTransitions=t.body.answerTransitions,this.resumeText=t.body.resumeText?t.body.resumeText:""},saveData(){this.UPDATE_QUESTION_DATA()},moveToId(t){this.questionId=t,this.GET_QUESTION_DATA()},selectQuestion(t){this.actionQuestionsModal=t,this.showQuestionsModal=!0},closeModal(){this.showQuestionsModal=!1,this.actionQuestionsModal=""},addQuestion(t){this.answerTransitions.push({transitionId:t,answerText:""}),this.GET_AND_ADD_PARENT(t),this.UPDATE_QUESTION_DATA(),this.actionQuestionsModal=""},moveToQuestion(t){this.moveToId(t),this.actionQuestionsModal=""},closeWarning(){this.showWarning=!1,this.warningText=""},checkingAuth(){const t=localStorage.getItem("token");t?(this.token=t,this.isAuth=!0,this.GET_QUESTION_DATA()):this.isAuth=!1},LOGINING(t){(0,U.Z)({method:"post",url:`${this.authServer}/signin`,data:t}).then((t=>{this.writeToken(t.data.data.token.auth_token),console.log(t)})).then((()=>{this.GET_QUESTION_DATA()})).catch((t=>(console.log("Ошибка: не верный пароль."),t)))},writeToken(t){this.token=t,this.isAuth=!0,localStorage.setItem("token",t)}},mounted(){this.checkingAuth()}};const rt=(0,a.Z)(at,[["render",D]]);var dt=rt;const lt=[{path:"/",name:"QuestionPage2",component:dt},{path:"/test:testId/question:questionId",name:"question",component:dt}],ut=(0,u.p7)({history:(0,u.r5)(),routes:lt});var ht=ut,ct=n(65),Tt=(0,ct.MT)({state:{serverURL:"https://dev1.med-game.ru/api/v1",testId:11,questionId:563},getters:{testId(t){return t.testId},questionId(t){return t.questionId}},mutations:{setDataQuestion(t,e){t.parentId=e.body.parentId,t.infoText=e.body.infoText,t.questionText=e.body.questionText,t.answerTransitions=e.body.answerTransitions},setParentTexts(t,e){t.parentInfoText=e.body.infoText,t.parentQuestionText=e.body.questionText}},actions:{GET_QUESTION_DATA({state:t,commit:e,dispatch:n}){(0,U.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.questionId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setDataQuestion",t.data.data),console.log(t)})).then((()=>!t.parentId||n("GET_PARENT_TEXTS"))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},GET_PARENT_TEXTS({state:t,commit:e}){(0,U.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.parentId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setParentTexts",t.data.data),console.log("33333333333"),console.log(t)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},moveToId({state:t,dispatch:e},n){return t.questionId=n,e("GET_QUESTION_DATA")}},modules:{}}),gt=n(9529);n(4415);(0,o.ri)(l).use(Tt).use(ht).use(gt.Z).mount("#app")}},e={};function n(o){var s=e[o];if(void 0!==s)return s.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,o,s,i){if(!o){var a=1/0;for(u=0;u<t.length;u++){o=t[u][0],s=t[u][1],i=t[u][2];for(var r=!0,d=0;d<o.length;d++)(!1&i||a>=i)&&Object.keys(n.O).every((function(t){return n.O[t](o[d])}))?o.splice(d--,1):(r=!1,i<a&&(a=i));if(r){t.splice(u--,1);var l=s();void 0!==l&&(e=l)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[o,s,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var s,i,a=o[0],r=o[1],d=o[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);if(d)var u=d(n)}for(e&&e(o);l<a.length;l++)i=a[l],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(u)},o=self["webpackChunkmedtest12"]=self["webpackChunkmedtest12"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(3830)}));o=n.O(o)})();
//# sourceMappingURL=app.9275dcb9.js.map